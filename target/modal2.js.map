{"version":3,"sources":["../js/modal2.js"],"names":["data","FormData","document","getElementById","dataToJSON","JSON","stringify","Object","fromEntries","url","$","on","e","preventDefault","ajax","type","dataType","success","msg","console","log","error","showErrors","cache","contentType","processData","each","errors","responseJSON","attr","parent","closest","addClass","append"],"mappings":";;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAGI,IAAMA,IAAI,GAAG,IAAIC,QAAJ,CAAaC,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CAAb,CAAb;AACA,IAAMC,UAAU,GAAGC,IAAI,CAACC,SAAL,CAAeC,MAAM,CAACC,WAAP,CAAmBR,IAAnB,CAAf,CAAnB;AACA,IAAMS,GAAG,GAAG,oCAAZ;AAEAC,CAAC,CAAC,QAAD,CAAD,CAAYC,EAAZ,CAAe,QAAf,EAAyB,UAASC,CAAT,EAAY;AACjCA,EAAAA,CAAC,CAACC,cAAF;AAEAH,EAAAA,CAAC,CAACI,IAAF,CAAO;AACHL,IAAAA,GAAG,EAAEA,GADF;AAEHM,IAAAA,IAAI,EAAE,MAFH;AAGHf,IAAAA,IAAI,EAAEI,UAHH;AAIHY,IAAAA,QAAQ,EAAE,MAJP;AAKHC,IAAAA,OAAO,EAAE,iBAAUC,GAAV,EAAe;AACpBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,KAPE;AAQHG,IAAAA,KAAK,EAAE,eAAUH,GAAV,EAAe;AAClBI,MAAAA,UAAU,CAACJ,GAAD,CAAV;AACH,KAVE;AAWHK,IAAAA,KAAK,EAAE,KAXJ;AAYHC,IAAAA,WAAW,EAAE,KAZV;AAaHC,IAAAA,WAAW,EAAE;AAbV,GAAP;AAgBH,CAnBD;;AAqBA,SAASH,UAAT,CAAoBJ,GAApB,EAAyB;AACrBR,EAAAA,CAAC,CAAC,6BAAD,CAAD,CAAiCgB,IAAjC,CAAsC,YAAY;AAC9C,SAAK,IAAIC,MAAT,IAAmBT,GAAG,CAACU,YAAJ,CAAiBD,MAApC,EAA4C;AACxC,UAAIA,MAAM,IAAIjB,CAAC,CAAC,IAAD,CAAD,CAAQmB,IAAR,CAAa,MAAb,CAAd,EAAoC;AAChC,YAAIC,MAAM,GAAGpB,CAAC,CAAC,IAAD,CAAD,CAAQqB,OAAR,CAAgB,iBAAhB,CAAb;AACAD,QAAAA,MAAM,CAACE,QAAP,CAAgB,sBAAhB,EAFgC,CAIhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAK,IAAIX,KAAT,IAAkBH,GAAG,CAACU,YAAJ,CAAiBD,MAAjB,CAAwBA,MAAxB,CAAlB,EAAmD;AAC/CG,UAAAA,MAAM,CAACG,MAAP,CAAc,+BAA+Bf,GAAG,CAACU,YAAJ,CAAiBD,MAAjB,CAAwBA,MAAxB,EAAgCN,KAAhC,CAA/B,GAAwE,MAAtF;AACH;AACJ;AACJ;AACJ,GApBD;AAqBH,C,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACJ;AAGA","sourcesContent":["// const fillNameField = document.querySelector('#form1 input[name=\"name\"]').parentNode;\r\n// const fillEmailField = document.querySelector('#form1 input[name=\"email\"]').parentNode;\r\n// const selectPlace = document.getElementById('select-place');\r\n// const formSubmit = document.getElementById('form1');\r\n\r\n// const ERROR_CLASSNAME = 'block08__input_error';\r\n// const FOCUSED_CLASSNAME = 'block08__input_filled';\r\n// const SELECTED_CLASSNAME = 'block08__select_selected';\r\n// const SELECTED_ERROR = 'block08__select-error';\r\n\r\n// function initializeFormField(field) {\r\n//     const input = field.getElementsByTagName('input')[0];\r\n//     const fieldError = field.querySelector('.block08__error');\r\n\r\n//     reset();\r\n\r\n//     function clearError() {\r\n//         field.classList.remove(ERROR_CLASSNAME);\r\n//         fieldError.innerText = '';\r\n//     }\r\n\r\n//     input.addEventListener('focus', function () {\r\n//         field.classList.add(FOCUSED_CLASSNAME);\r\n//     })\r\n\r\n//     input.addEventListener('blur', () => {\r\n//         if (!input.value) {\r\n//             field.classList.remove(FOCUSED_CLASSNAME);\r\n//         }\r\n//     })\r\n\r\n//     input.addEventListener('input', () => {\r\n//         clearError();\r\n//     })\r\n\r\n//     function reset() {\r\n//         input.value = '';\r\n//         field.classList.remove(FOCUSED_CLASSNAME);\r\n//         clearError();\r\n//     }\r\n\r\n//     return {\r\n//         addError(errorText) {\r\n//             field.classList.add(ERROR_CLASSNAME);\r\n//             fieldError.innerText = errorText;\r\n//         },\r\n//         getValue() {\r\n//             return input.value\r\n//         },\r\n//         focus() {\r\n//             input.focus()\r\n//         },\r\n//         reset: reset\r\n//     }\r\n// }\r\n\r\n// const fillNameFieldUtils = initializeFormField(fillNameField);\r\n// const fillEmailFieldUtils = initializeFormField(fillEmailField);\r\n\r\n// selectPlace.addEventListener('change', () => {\r\n//     selectPlace.classList.add(SELECTED_CLASSNAME);\r\n//     selectPlace.classList.remove(SELECTED_ERROR);\r\n// });\r\n\r\n// function handleSubmitForm(event) {\r\n//     event.preventDefault();\r\n    \r\n//     const nameValue = fillNameFieldUtils.getValue();\r\n//     const emailValue = fillEmailFieldUtils.getValue();\r\n\r\n//     if (!nameValue) {\r\n//         fillNameFieldUtils.addError('Необходимо указать имя');\r\n//         return;\r\n//     }\r\n\r\n//     if (!emailValue) {\r\n//         fillEmailFieldUtils.addError('Укажите email');\r\n//         return;\r\n//     }\r\n\r\n//     if (!/^[\\w-]{2,16}@[\\w-]{3,6}\\.[a-z]{2,3}$/i.test(emailValue)) {\r\n//         fillEmailFieldUtils.addError('Невалидный email');\r\n//         return;\r\n//     }\r\n\r\n//     if (selectPlace.value === 'none') {\r\n//         selectPlace.classList.add(SELECTED_ERROR);\r\n//         selectPlace.classList.add('block08__error');\r\n//         return;\r\n//     }\r\n\r\n\r\n    const data = new FormData(document.getElementById('form1'));\r\n    const dataToJSON = JSON.stringify(Object.fromEntries(data));\r\n    const url = 'http://study.xeol.ru/api/new_order';\r\n\r\n    $('#form1').on('submit', function(e) {\r\n        e.preventDefault();\r\n    \r\n        $.ajax({\r\n            url: url,\r\n            type: 'post',\r\n            data: dataToJSON,\r\n            dataType: 'json',\r\n            success: function (msg) {\r\n                console.log(msg)\r\n            },\r\n            error: function (msg) {\r\n                showErrors(msg)\r\n            },\r\n            cache: false,\r\n            contentType: false,\r\n            processData: false,\r\n        })\r\n\r\n    })\r\n    \r\n    function showErrors(msg) {\r\n        $('#form1 input, #form1 select').each(function () {\r\n            for (let errors in msg.responseJSON.errors) {\r\n                if (errors == $(this).attr('name')) {\r\n                    let parent = $(this).closest('.block08__input');\r\n                    parent.addClass('block08__input_error');\r\n                    \r\n                    // // if (!parent.length) {\r\n                    // //     parent = $(this).closest('.block08__select-wrap');\r\n                    // //     parent.addClass('block08__select-error');\r\n                    // // }\r\n                    // // if (!parent.length) {\r\n                    // //     parent = $(this).closest('.block08__checkbox');\r\n                    // //     parent.addClass('block08__select-error');\r\n                    // }\r\n                    \r\n                    for (let error in msg.responseJSON.errors[errors]) {\r\n                        parent.append('<p class=\"block08__error\">' + msg.responseJSON.errors[errors][error] + '</p>');\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    // fetch(url, {\r\n    //       method: 'POST',\r\n    //       cache: 'no-cache',\r\n    //       headers: {\r\n    //           'Content-Type': 'application/json',\r\n    //       },\r\n    //       body: JSON.stringify(data),\r\n    // })\r\n    // .then((data) => {\r\n    //     fillNameFieldUtils.reset();\r\n    //     fillEmailFieldUtils.reset();\r\n    //     selectPlace.value = 'none';\r\n    //     selectPlace.classList.remove(SELECTED_CLASSNAME);\r\n    // });\r\n// }\r\n    \r\n\r\n// formSubmit.addEventListener('submit', handleSubmitForm);\r\n\r\n\r\n\r\n"],"file":"modal2.js"}