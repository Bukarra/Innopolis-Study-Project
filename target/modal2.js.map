{"version":3,"sources":["../js/modal2.js"],"names":["fillNameField","document","querySelector","parentNode","fillEmailField","selectPlace","getElementById","formSubmit","ERROR_CLASSNAME","FOCUSED_CLASSNAME","SELECTED_CLASSNAME","SELECTED_ERROR","initializeFormField","field","input","getElementsByTagName","fieldError","reset","clearError","classList","remove","innerText","addEventListener","add","value","addError","errorText","getValue","focus","fillNameFieldUtils","fillEmailFieldUtils","handleSubmitForm","event","preventDefault","nameValue","emailValue","test","data","FormData","url","$","ajax","type","dataType","success","msg","console","log","error","showErrors","cache","contentType","processData"],"mappings":"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","sourcesContent":["const fillNameField = document.querySelector('#form1 input[name=\"name\"]').parentNode;\r\nconst fillEmailField = document.querySelector('#form1 input[name=\"email\"]').parentNode;\r\nconst selectPlace = document.getElementById('select-place');\r\nconst formSubmit = document.getElementById('form1');\r\n\r\nconst ERROR_CLASSNAME = 'block08__input_error';\r\nconst FOCUSED_CLASSNAME = 'block08__input_filled';\r\nconst SELECTED_CLASSNAME = 'block08__select_selected';\r\nconst SELECTED_ERROR = 'block08__select-error';\r\n\r\nfunction initializeFormField(field) {\r\n    const input = field.getElementsByTagName('input')[0];\r\n    const fieldError = field.querySelector('.block08__error');\r\n\r\n    reset();\r\n\r\n    function clearError() {\r\n        field.classList.remove(ERROR_CLASSNAME);\r\n        fieldError.innerText = '';\r\n    }\r\n\r\n    input.addEventListener('focus', function () {\r\n        field.classList.add(FOCUSED_CLASSNAME);\r\n    })\r\n\r\n    input.addEventListener('blur', () => {\r\n        if (!input.value) {\r\n            field.classList.remove(FOCUSED_CLASSNAME);\r\n        }\r\n    })\r\n\r\n    input.addEventListener('input', () => {\r\n        clearError();\r\n    })\r\n\r\n    function reset() {\r\n        input.value = '';\r\n        field.classList.remove(FOCUSED_CLASSNAME);\r\n        clearError();\r\n    }\r\n\r\n    return {\r\n        addError(errorText) {\r\n            field.classList.add(ERROR_CLASSNAME);\r\n            fieldError.innerText = errorText;\r\n        },\r\n        getValue() {\r\n            return input.value\r\n        },\r\n        focus() {\r\n            input.focus()\r\n        },\r\n        reset: reset\r\n    }\r\n}\r\n\r\nconst fillNameFieldUtils = initializeFormField(fillNameField);\r\nconst fillEmailFieldUtils = initializeFormField(fillEmailField);\r\n\r\nselectPlace.addEventListener('change', () => {\r\n    selectPlace.classList.add(SELECTED_CLASSNAME);\r\n    selectPlace.classList.remove(SELECTED_ERROR);\r\n});\r\n\r\nfunction handleSubmitForm(event) {\r\n    event.preventDefault();\r\n    \r\n    const nameValue = fillNameFieldUtils.getValue();\r\n    const emailValue = fillEmailFieldUtils.getValue();\r\n\r\n    if (!nameValue) {\r\n        fillNameFieldUtils.addError('Необходимо указать имя');\r\n        return;\r\n    }\r\n\r\n    if (!emailValue) {\r\n        fillEmailFieldUtils.addError('Укажите email');\r\n        return;\r\n    }\r\n\r\n    if (!/^[\\w-]{2,16}@[\\w-]{3,6}\\.[a-z]{2,3}$/i.test(emailValue)) {\r\n        fillEmailFieldUtils.addError('Невалидный email');\r\n        return;\r\n    }\r\n\r\n    if (selectPlace.value === 'none') {\r\n        selectPlace.classList.add(SELECTED_ERROR);\r\n        selectPlace.classList.add('block08__error');\r\n        return;\r\n    }\r\n\r\n\r\n    const data = new FormData(document.getElementById('form1'));\r\n    const url = 'http://study.xeol.ru/api/new_order';\r\n\r\n    // $('#form1').on('submit', function(e) {\r\n    //     e.preventDefault();\r\n    \r\n        $.ajax({\r\n            url: url,\r\n            type: 'POST',\r\n            data: data,\r\n            dataType: 'json',\r\n            success: function (msg) {\r\n                console.log(msg)\r\n            },\r\n            error: function (msg) {\r\n                showErrors(msg)\r\n            },\r\n            cache: false,\r\n            contentType: false,\r\n            processData: false,\r\n        })\r\n\r\n    // })\r\n    \r\n    // function showErrors(msg) {\r\n    //     $('#form1 input, #form1 select').each(function () {\r\n    //         for (let errors in msg.responseJSON.errors) {\r\n    //             if (errors == $(this).attr('name')) {\r\n    //                 let parent = $(this).closest('.block08__input');\r\n    //                 parent.addClass('block08__input_error');\r\n                    \r\n    //                 // // if (!parent.length) {\r\n    //                 // //     parent = $(this).closest('.block08__select-wrap');\r\n    //                 // //     parent.addClass('block08__select-error');\r\n    //                 // // }\r\n    //                 // // if (!parent.length) {\r\n    //                 // //     parent = $(this).closest('.block08__checkbox');\r\n    //                 // //     parent.addClass('block08__select-error');\r\n    //                 // }\r\n                    \r\n    //                 for (let error in msg.responseJSON.errors[errors]) {\r\n    //                     parent.append('<p class=\"block08__error\">' + msg.responseJSON.errors[errors][error] + '</p>');\r\n    //                 }\r\n    //             }\r\n    //         }\r\n    //     })\r\n    // }\r\n\r\n    // fetch(url, {\r\n    //       method: 'POST',\r\n    //       cache: 'no-cache',\r\n    //       headers: {\r\n    //           'Content-Type': 'application/json',\r\n    //       },\r\n    //       body: JSON.stringify(data),\r\n    // })\r\n    // .then((data) => {\r\n    //     fillNameFieldUtils.reset();\r\n    //     fillEmailFieldUtils.reset();\r\n    //     selectPlace.value = 'none';\r\n    //     selectPlace.classList.remove(SELECTED_CLASSNAME);\r\n    // });\r\n}\r\n    \r\n\r\nformSubmit.addEventListener('submit', handleSubmitForm);\r\n\r\n\r\n\r\n"],"file":"modal2.js"}